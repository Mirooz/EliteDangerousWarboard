<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.*?>

<?import be.mirooz.elitedangerous.dashboard.controller.ui.component.GenericListView?>
<StackPane xmlns="http://javafx.com/javafx/11.0.1" xmlns:fx="http://javafx.com/fxml/1"
           fx:controller="be.mirooz.elitedangerous.dashboard.controller.MassacreSearchDialogController">

    <VBox spacing="20.0" styleClass="dialog-content">
    <padding>
        <Insets bottom="20.0" left="20.0" right="20.0" top="20.0"/>
    </padding>

    <!-- En-tête avec titre -->
    <HBox alignment="CENTER_LEFT" spacing="15.0" styleClass="dialog-header">
        <VBox spacing="2.0">
            <Label text="RECHERCHE DE SYSTÈMES POUR MISSIONS" styleClass="dialog-title"/>
            <Label text="Massacre et zones de conflit" styleClass="dialog-subtitle"/>
        </VBox>
    </HBox>

    <!-- TabPane pour les différents types de recherche -->
    <TabPane fx:id="searchTabPane" styleClass="elite-tab-pane" VBox.vgrow="ALWAYS">
        <!-- Onglet Massacre -->
        <Tab text="MASSACRE" closable="false">
            <VBox spacing="15.0">
                <!-- Panneau de configuration compact -->
                <HBox alignment="CENTER_LEFT" spacing="20.0" styleClass="config-panel">
                    <HBox alignment="CENTER_LEFT" spacing="10.0">
                        <Label text="SYSTÈME:" styleClass="config-label"/>
                        <TextField fx:id="referenceSystemField" styleClass="config-field" prefWidth="150"
                                   promptText="Système de référence"/>
                    </HBox>

                    <HBox alignment="CENTER_LEFT" spacing="10.0">
                        <Label text="DISTANCE MAX:" styleClass="config-label"/>
                        <Spinner fx:id="maxDistanceSpinner" editable="true" initialValue="100" min="30" max="250" prefWidth="80"
                                 styleClass="config-spinner"/>
                        <Label text="AL" styleClass="config-unit"/>
                    </HBox>

                    <HBox alignment="CENTER_LEFT" spacing="10.0">
                        <Label text="SOURCES MIN:" styleClass="config-label"/>
                        <Spinner fx:id="minSourcesSpinner" editable="true" initialValue="1" min="1" max="5" prefWidth="70"
                                 styleClass="config-spinner"/>
                        <Label text="SOURCES" styleClass="config-unit"/>
                    </HBox>
                    
                    <HBox alignment="CENTER_LEFT" spacing="10.0">
                        <CheckBox fx:id="LPADonly">
                            <tooltip>
                                <Tooltip showDelay="50ms" text="Large PAD uniquement"/>
                            </tooltip>
                        </CheckBox>
                        <Label text="L" styleClass="massacre-card-pad"/>
                    </HBox>

                    <Region HBox.hgrow="ALWAYS"/>

                    <Button fx:id="searchButton" mnemonicParsing="false" onAction="#searchMassacreSystems" styleClass="elite-button"
                            text="RECHERCHER"/>
                </HBox>
                
                <!-- En-tête des factions -->
                <HBox alignment="CENTER_LEFT" spacing="20.0" styleClass="faction-header">
                    <Label text="SOURCE" styleClass="faction-header-label" prefWidth="100"/>
                    <Label text="CIBLE" styleClass="faction-header-label" prefWidth="80"/>
                    <Label text="[ # ]" styleClass="faction-header-label,hoverable-label" prefWidth="45">
                        <tooltip>
                            <Tooltip showDelay="50ms" text="Nombre de systèmes source pour ce système cible"/>
                        </tooltip>
                    </Label>
                    <Label text="DISTANCE" styleClass="faction-header-label" prefWidth="70"/>
                    <Label text="PADS" styleClass="faction-header-label" prefWidth="60"/>
                    <HBox alignment="CENTER" spacing="40.0">
                        <VBox alignment="CENTER" spacing="5.0">
                            <ImageView fx:id="fedHeaderIcon" fitHeight="35.0" fitWidth="35.0" pickOnBounds="true" styleClass="icon-cursor"
                                       preserveRatio="true" onMouseClicked="#toggleHighlight" userData="federation"/>
                        </VBox>
                        <VBox alignment="CENTER" spacing="5.0">
                            <ImageView fx:id="impHeaderIcon" fitHeight="35.0" fitWidth="35.0" pickOnBounds="true" styleClass="icon-cursor"
                                       preserveRatio="true" onMouseClicked="#toggleHighlight" userData="empire"/>
                        </VBox>
                        <VBox alignment="CENTER" spacing="5.0">
                            <ImageView fx:id="allHeaderIcon" fitHeight="35.0" fitWidth="35.0" pickOnBounds="true" styleClass="icon-cursor"
                                       preserveRatio="true" onMouseClicked="#toggleHighlight" userData="alliance"/>
                        </VBox>
                        <VBox alignment="CENTER" spacing="5.0">
                            <ImageView fx:id="indHeaderIcon" fitHeight="35.0" fitWidth="35.0" pickOnBounds="true" styleClass="icon-cursor"
                                       preserveRatio="true" onMouseClicked="#toggleHighlight" userData="independent"/>
                        </VBox>
                    </HBox>
                    <Label text="RES" styleClass="faction-header-label" translateX="30"/>
                </HBox>
                
                <!-- Liste des systèmes massacre -->
                <GenericListView fx:id="systemList"
                                 styleClass="missions-scroll"
                                 VBox.vgrow="ALWAYS"/>
            </VBox>
        </Tab>
        
        <!-- Onglet Conflit -->
        <Tab text="CONFLIT" closable="false">
            <VBox spacing="15.0">
                <!-- Panneau de configuration pour les conflits -->
                <HBox alignment="CENTER_LEFT" spacing="20.0" styleClass="config-panel">
                    <HBox alignment="CENTER_LEFT" spacing="10.0">
                        <Label text="SYSTÈME:" styleClass="config-label"/>
                        <TextField fx:id="conflictReferenceSystemField" styleClass="config-field" prefWidth="150"
                                   promptText="Système de référence"/>
                    </HBox>
                    <Region HBox.hgrow="ALWAYS"/>
                    
                    <Button fx:id="conflictSearchButton" mnemonicParsing="false" onAction="#searchConflictSystems" styleClass="elite-button"
                            text="RECHERCHER"/>
                </HBox>
                
                <!-- En-tête pour les conflits -->
                <HBox alignment="CENTER_LEFT" spacing="15.0" styleClass="conflict-header">
                    <Label text="SYSTÈME" styleClass="faction-header-label" prefWidth="140"/>
                    <Label text="DISTANCE" styleClass="faction-header-label" prefWidth="90"/>
                    <Label text="FACTION" styleClass="faction-header-label" prefWidth="160"/>
                    <Label text="OPPOSANT" styleClass="faction-header-label" prefWidth="180"/>
                    <Label text="CONFLIT DE SURFACE" styleClass="faction-header-label" prefWidth="200"/>
                </HBox>
                
                <!-- Liste des conflits -->
                <GenericListView fx:id="conflictList"
                                 styleClass="missions-scroll"
                                 VBox.vgrow="ALWAYS"/>
            </VBox>
        </Tab>
    </TabPane>

    <!-- Panneau des boutons d'action -->
    <HBox alignment="CENTER_RIGHT" spacing="15.0" styleClass="action-panel">
        <Button fx:id="closeButton" mnemonicParsing="false" onAction="#closeDialog" styleClass="elite-button-secondary"
                text="FERMER"/>
    </HBox>
    </VBox>

    <ProgressIndicator fx:id="loadingIndicator"
                       maxWidth="100" maxHeight="100"
                       visible="false" />

    <!-- Conteneur pour les popups - au-dessus de tout -->
    <StackPane fx:id="popupContainer" mouseTransparent="true"/>

</StackPane>
